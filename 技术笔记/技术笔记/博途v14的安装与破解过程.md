# 博途v14的安装与破解过程

> 有能力购买的朋友还请支持正版。

## 0x00 准备工作
* Windows 10 x64
* SIMATIC_STEP_7_Professional_V14_SP1
* Sim_EKB_Install_2017_04_01

## 0x01 安装
1. 打开安装包文件夹，运行`SIMATIC_STEP_7_Professional_V14_SP1.exe`。
![安装包文件夹](_v_images/20190918225134901_24902.png)
![解压安装程序](_v_images/20190918225209174_12811.png)

2. 选择简体中文。
![选择简体中文](_v_images/20190918230424230_29107.png)

3. 因为这只是解压缩安装程序，所以先指定一个临时的存放目录，放固态后面安装速度会快些，并且为了方便我放在了桌面。安装完成后可以删除。
![指定解压目录](_v_images/20190918231111566_23937.png)
![等待解压完成](_v_images/20190918231321332_6066.png)

4. 解压完成后提示重启，最好先重启试下。有些人会遇到无限重启的情况之后再说。
![重启电脑](_v_images/20190918231506980_13948.png)

5. 重启后自动开始安装，选择中文。
![选择中文](_v_images/20190918231720741_24442.png)

6. 再选择中文，如有需要可以安装多个语言。
![选择中文](_v_images/20190918231846910_19489.png)

7. 尽量把所有组件都安装上，安装目录中不要出现中文。
![安装组件](_v_images/20190918232051445_10295.png)

8. 接受许可证条款。
![接受许可证条款](_v_images/20190918232212020_25346.png)

9. 接受对系统的设置。
![接受对系统的设置](_v_images/20190918232311530_26090.png)

10. 确认安装信息。
![确认安装信息](_v_images/20190918232355892_8713.png)

11. 等待安装。
![等待安装](_v_images/20190918232431698_17172.png)

12. 如果很快就出现需要重启才能继续，重启后仍会提示重启的情况，就先不重启。选择【否，稍后重启计算机】并点击【关闭】退出安装程序。
![无限重启](_v_images/20190918232714204_13293.png)
![取消重启](_v_images/20190918232743042_10468.png)

13. 打开注册表编辑器，找到`计算机\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager`，在右边找到`PendingFileRenameOperations`，删除这个值，关闭注册表编辑器。
![删除注册表值](_v_images/20190918233127397_26921.png)

14. 打开解压的安装程序目录，运行`Start.exe`，重新开始安装。
![重新运行安装程序](_v_images/20190918234043044_10698.png)
![继续安装](_v_images/20190918234523626_1737.png)

15. 整个安装过程大概用时30分钟，中途会提示无法执行许可证传送，点击【跳过许可证传送】即可，安装完成后再进行破解。如果在安装之前就破解过了就不会出现这个。
![跳过许可证传送](_v_images/20190918235445212_27027.png)

16. 安装完成后不需要重启，选择【否，稍后重启计算机】并点击【关闭】退出。由于上一步跳过了许可证传送而出现的警告信息不用管。
![安装完成](_v_images/20190919000428851_29170.png)

## 0x02 破解
1. 打开`Sim_EKB_Install_2017_04_01.exe`，在【需要的密钥】中全选，点击【安装长密钥】，许可证变蓝即可。左上角可以选择密钥存放的磁盘，这会在磁盘根目录新建一个名叫`AX NF ZZ`的文件夹，里面存放的是对应的密钥文件，属性为系统文件。
![安装密钥](_v_images/20190919001110559_14810.png)
![破解完成](_v_images/20190919001910311_18597.png)
![密钥文件夹](_v_images/20190919003240625_14828.png)

2. 破解后再打开博途软件，新建项目，确认没有问题。
![打开博途](_v_images/20190919003936401_22927.png)

## 0x03 注意事项
1. 安装前最好先关闭各种杀毒软件，以免误报拦截。如果忘关了，弹出警告时都选择允许操作。我是开着360安装的，中途有几次拦截我都允许了，但仍有两次被自动阻止了，后续来看的话问题不大，不影响使用。
![拦截记录](_v_images/20190919153247524_5418.png)

2. 运行博途时如果弹出【STEP 7 Basic | Professional的许可无法彻底完成，因为Automation License Manager中发生了内部错误。】，有可能是因为`Automation License Manager Service`服务没有启动。打开计算机管理，在【服务】中找到`Automation License Manager Service`，双击打开属性，将【启动类型】改为【自动】，点击【启动】，最后点击【确定】退出，重新打开博途就可以了。
![服务](_v_images/20190919162330474_6625.png)
![启动服务](_v_images/20190919162742229_31643.png)

3. 如果新建项目后无法添加设备，在博途的快捷方式属性中勾选【以兼容模式运行这个程序】并选择为【Windows 7】，同时勾选【以管理员身份运行此程序】，点击【确定】退出，重新打开博途就可以了。
![兼容模式以及管理员身份运行](_v_images/20190919164011273_22462.png)

4. 如果提示诸如许可证无效、未找到有效的许可证密钥、许可证已过期之类的情况，将`AX NF ZZ`文件夹删除后重新安装密钥即可。

5. 其他问题可以参考[博途TIA Portal安装与使用常见问题解答](http://www.ad.siemens.com.cn/club/bbs/post_elite.aspx?b_id=50&a_id=1564653)。